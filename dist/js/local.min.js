var Modal=React.createClass({displayName:"Modal",propTypes:{id:React.PropTypes.number.isRequired,label:React.PropTypes.string.isRequired,name:React.PropTypes.string.isRequired,modal:React.PropTypes.number.isRequired,onClick:React.PropTypes.func},render:function(){var e=this.props.onClick?React.createElement("button",{"aria-label":"Close",className:"close",onClick:this.props.onClick,type:"button"},React.createElement("span",{"aria-hidden":"true"},"Ã—")):null,t="modal-"+this.props.name+"-label";return React.createElement("div",{"aria-labelledby":t,className:"modal fade in",id:"modal-"+this.props.name,role:"dialog",style:{display:this.props.id==this.props.modal?"block":"none"},tabIndex:"-1"},React.createElement("div",{className:"modal-dialog modal-sm",role:"document"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},e,React.createElement("strong",{id:t},this.props.label)),React.createElement("div",{className:"modal-body"},this.props.children))))}}),PositionItem=React.createClass({displayName:"PositionItem",render:function(){return React.createElement("a",{className:"list-group-item",href:"#",onClick:this.props.onClick},React.createElement("p",{className:"list-group-item-text"},React.createElement("span",{"aria-hidden":"true",className:"glyphicon glyphicon-map-marker"})," ",React.createElement("strong",null,this.props.latitude,", ",this.props.longitude)),React.createElement("p",{className:"list-group-item-text"},React.createElement("span",{"aria-hidden":"true",className:"glyphicon glyphicon-time"})," ",this.props.timestamp),React.createElement("p",{className:""==this.props.description?"hidden":"list-group-item-text"},React.createElement("span",{"aria-hidden":"true",className:"glyphicon glyphicon-comment"})," ",this.props.description))}}),MODAL={NONE:0,CONTEXT:1},POSITION_TEMPLATE=Object.assign({},{id:0,description:"",latitude:0,longitude:0,timestamp:0}),GeoLog=React.createClass({displayName:"GeoLog",propTypes:{onClick:React.PropTypes.func},getInitialState:function(){return{modal:MODAL.NONE,id:0,position:POSITION_TEMPLATE,positions:[]}},componentDidMount:function(){var e=parseInt(localStorage.getItem("id")||0),t=JSON.parse(localStorage.getItem("positions"))||[];this.setState({id:e,positions:t})},render:function(){var e=[];return _.orderBy(this.state.positions,["timestamp"],["desc"]).forEach(function(t){e.push(React.createElement(PositionItem,{key:t.id,description:t.description,latitude:t.latitude,longitude:t.longitude,timestamp:t.timestamp,onClick:this.modalOpen.bind(this,MODAL.CONTEXT,t.id)}))},this),React.createElement("div",null,React.createElement("div",{className:"container"},React.createElement("div",{className:"page-header"},React.createElement("h1",null,"GeoLog")),React.createElement("button",{className:"btn btn-lg btn-success btn-block",onClick:this.addPosition},"Add position"),React.createElement("hr",null),React.createElement("div",{className:"list-group"},e)),React.createElement(Modal,{id:MODAL.CONTEXT,label:"What do you want to du?",modal:this.state.modal,name:"context",onClick:this.modalClose},React.createElement("p",null,"Context modal goes here")),React.createElement("div",{className:this.state.modal==MODAL.NONE?"hidden":"modal-backdrop fade in"}))},modalOpen:function(e,t,a){a.preventDefault();var i=_.find(this.state.positions,["id",t]);void 0!==i&&console.log(i),this.setState({modal:e})},modalClose:function(e){e.preventDefault(),this.setState({modal:MODAL.NONE})},updateStorage:function(){localStorage.setItem("id",this.state.id),localStorage.setItem("positions",JSON.stringify(this.state.positions))},addPosition:function(e){navigator.geolocation.getCurrentPosition(this.getPositionSuccess,this.getPositionError)},getPositionSuccess:function(e){var t=this.state.id+1,e=Object.assign({},this.state.position,{id:t,latitude:e.coords.latitude,longitude:e.coords.longitude,timestamp:e.timestamp}),a=this.state.positions;a.push(e),this.setState({id:t,positions:a},this.updateStorage)},getPositionError:function(e){console.log("code: %s, message: %s",e.code,e.message)}});